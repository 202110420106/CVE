## **Vulnerability Title:**

SeaCMS存在sql注入漏洞

## **Affected Versions:**

SeaCMS <=13.2

## **Discovery Time:**

2025/1/15

## **Discoverer:**

zhiwei.pu

## **Analysis Report:**

filename: \admin\ebak\phome.php

![img](/images/image1.png)

All parameter arrays passed in the POST request

Enter the Ebak_DoExecSql() method

![img](/images/image2.png)]

The "mydbname" parameter must be the name of an existing database; otherwise, an error will be reported.

Execute the Ebak_ClearAddsData () method first. Remove the existence of escape characters in the parameter.

![img](/images/image3.png)

Moving on to the most critical Ebak_DoRunQuery () function

![img](/images/image4.png)

![img](/images/image5.png)

The general process is to filter the incoming parameters and truncate the statement according to the semicolon, and remove the redundant characters, leaving only the simple sql statement. Finally, the sql statement is executed using the query method.

## **Remediation Plan:**

1. Use parameterized queries to ensure user input is separated from SQL statements.
2. Validate and sanitize user input to prevent special character injection.
3. Assign minimal database permissions to reduce the impact of attacks.